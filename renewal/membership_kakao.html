<style>
  .membership-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 60px 20px;
    text-align: center;
  }

  .sub-desc {
    font-size: 25px !important;
    line-height: 1.6 !important;
    color: #000 !important;
    margin-bottom: 30px;
  }

  .btn-black {
    display: inline-block;
    background-color: #000;
    color: #fff !important;
    padding: 15px 30px;
    text-decoration: none;
    font-weight: 500;
    border-radius: 5px;
    font-size: 16px;
  }

  /* Section Common */
  .section-title {
    font-size: 50px !important;
    font-weight: 700 !important;
    color: #000 !important;
    margin-bottom: 40px;
  }

  /* Kakao Section */
  .kakao-section {
    margin-bottom: 60px;
  }

  .kakao-steps {
    display: flex;
    justify-content: center;
    gap: 20px;
    margin: 40px 0;
    flex-wrap: wrap;
    /* Prevent overlapping on smaller desktop screens */
  }

  .step-item {
    flex: 1;
    min-width: 200px;
    /* Ensure a minimum width */
  }

  .step-num {
    width: 30px;
    height: 30px;
    background-color: #000;
    color: #fff;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    margin: 0 auto 20px;
  }

  .step-img-box {
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 20px;
    overflow: hidden;
    /* Ensure image doesn't bleed out */
  }

  .step-img-box img {
    border-radius: 10px;
    max-width: 100%;
    height: auto;
    display: block;
    /* Remove bottom space */
  }

  .step-desc {
    font-size: 14px;
    line-height: 1.5;
    color: #333;
    word-break: keep-all;
    /* Better text wrapping for Korean */
  }

  /* Pagination Customization */
  .custom-pagination {
    display: none;
    justify-content: center;
    gap: 8px;
    margin-top: 20px;
  }

  .pagination-dot {
    width: 8px;
    height: 8px;
    background-color: #ccc;
    border-radius: 50%;
    cursor: pointer;
    transition: background-color 0.3s;
  }

  .pagination-dot.active {
    background-color: #000;
  }

  /* Mobile Responsive */
  @media (max-width: 768px) {
    .membership-container {
      padding: 40px 20px;
    }

    .section-title {
      font-size: 28px !important;
      /* Slightly smaller for better fit */
      margin-bottom: 30px;
      line-height: 1.3 !important;
    }

    .sub-desc {
      font-size: 14px !important;
      margin-bottom: 30px;
      word-break: keep-all;
    }

    /* Kakao Swiper on Mobile */
    .kakao-steps {
      display: flex;
      justify-content: flex-start;
      /* Force start alignment to prevent clipping */
      flex-wrap: nowrap;
      /* No wrap for slider */
      gap: 0;
      /* Full bleed adjustment */
      margin: 40px -20px 20px;
      padding: 0;
      /* Removed padding to ensure reliable snap */
      overflow-x: auto;
      scroll-snap-type: x mandatory;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none;
      /* Firefox */
      scroll-behavior: smooth;
    }

    .kakao-steps::-webkit-scrollbar {
      display: none;
      /* Chrome/Safari */
    }

    .step-item {
      max-width: none;
      flex: 0 0 100%;
      width: 100%;
      scroll-snap-align: center;
      padding: 0 20px;
      /* spacing inside slide to simulate container padding */
      box-sizing: border-box;
    }

    .step-img-box {
      /* Fix image ratio clipping */
      overflow: visible;
      height: auto;
      aspect-ratio: auto;
    }

    .kakao-swiper {
      padding-bottom: 20px;
      overflow: hidden;
    }

    .custom-pagination {
      display: flex;
    }

    .btn-black {
      width: 100%;
      box-sizing: border-box;
    }
  }
</style>

<div class="membership-container">
  <!-- Kakao Section -->
  <section class="kakao-section">
    <h2 class="section-title">카카오 플친 추가하고<br>10% 추가 혜택 받기</h2>
    <p class="sub-desc">
      지금 하우스보이의 카카오 채널을 팔로우하시고,<br>
      재미있는 브랜드 소식과 구매 금액에 따라 함께 커지는 혜택을 받아보세요
    </p>

    <div class="kakao-swiper">
      <div class="kakao-steps" id="kakaoGrid">
        <div class="step-item">
          <div class="step-num">1</div>
          <div class="step-img-box">
            <img src="https://raw.githubusercontent.com/kosuha/houseboy-imweb/main/membership-img-1.png" alt="카카오채널 검색"
              style="max-width: 100%; height: auto;">
          </div>
          <p class="step-desc">카카오채널 검색 후<br>팔로우해주세요.</p>
        </div>
        <div class="step-item">
          <div class="step-num">2</div>
          <div class="step-img-box">
            <img src="https://raw.githubusercontent.com/kosuha/houseboy-imweb/main/membership-img-2.png" alt="웰컴쿠폰받기"
              style="max-width: 100%; height: auto;">
          </div>
          <p class="step-desc">채팅방 메뉴에서<br>'웰컴쿠폰받기' 버튼을 눌러주세요.</p>
        </div>
        <div class="step-item">
          <div class="step-num">3</div>
          <div class="step-img-box">
            <img src="https://raw.githubusercontent.com/kosuha/houseboy-imweb/main/membership-img-3.png" alt="쿠폰번호 복사"
              style="max-width: 100%; height: auto;">
          </div>
          <p class="step-desc">표시된 쿠폰번호를 복사하신 후,<br>'쿠폰번호 등록하기'를 눌러주세요.</p>
        </div>
        <div class="step-item">
          <div class="step-num">4</div>
          <div class="step-img-box">
            <img src="https://raw.githubusercontent.com/kosuha/houseboy-imweb/main/membership-img-4.png" alt="쿠폰 코드 입력"
              style="max-width: 100%; height: auto;">
          </div>
          <p class="step-desc">공식몰에 로그인하신 뒤, 상품 구매 단계에서<br>복사된 쿠폰 코드를 입력해주세요.</p>
        </div>
      </div>
      <div class="custom-pagination" id="kakaoPagination"></div>
    </div>

    <a href="#" class="btn-black">카카오 플친 추가하고 추가 혜택 받기</a>
  </section>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    function setupSlider(gridId, paginationId) {
      const grid = document.getElementById(gridId);
      const pagination = document.getElementById(paginationId);

      if (!grid || !pagination) return;

      const items = grid.children;

      // Create pagination dots
      pagination.innerHTML = '';
      for (let i = 0; i < items.length; i++) {
        const dot = document.createElement('div');
        dot.classList.add('pagination-dot');
        if (i === 0) dot.classList.add('active');

        // Improved click handling
        dot.addEventListener('click', () => {
          // Identify the position of the target item
          // offsetLeft is relative to the offsetParent (which should be the grid if positioned, or we use calc)
          // Since grid is a flex container, simpler to using scrollTo with the item's offsetLeft relative to the grid
          const offset = items[i].offsetLeft;
          grid.scrollTo({
            left: offset,
            behavior: 'smooth'
          });
        });

        pagination.appendChild(dot);
      }

      // Update active dot on scroll using IntersectionObserver
      const observerOptions = {
        root: grid,
        threshold: 0.6 // Increased threshold to ensure we only highlight when mostly visible
      };

      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            const index = Array.from(items).indexOf(entry.target);
            const dots = pagination.children;

            if (dots && dots.length > 0) {
              // Reset all
              for (let d of dots) d.classList.remove('active');
              // Set active
              if (dots[index]) dots[index].classList.add('active');
            }
          }
        });
      }, observerOptions);

      Array.from(items).forEach(item => observer.observe(item));
    }

    // Initialize sliders
    setupSlider('kakaoGrid', 'kakaoPagination');
  });
</script>