<!-- renewal/membership_kakao.html -->

<style>
  .btn-black {
    display: inline-block;
    background-color: #000;
    color: #fff !important;
    padding: 15px;
    text-decoration: none;
    font-weight: 600;
    border-radius: 10px;
    font-size: 24px;
  }

  /* Section Common */
  .section-title {
    font-size: 50px !important;
    font-weight: 700 !important;
    color: #000 !important;
    margin-bottom: 40px;
  }

  /* Kakao Section */
  .kakao-section {
    margin-bottom: 60px;
  }

  .kakao-steps {
    display: flex;
    justify-content: center;
    gap: 20px;
    margin: 40px 0;
    flex-wrap: wrap;
    /* Prevent overlapping on smaller desktop screens */
  }

  .step-item {
    flex: 1;
    min-width: 200px;
    /* Ensure a minimum width */
  }

  .step-num {
    width: 30px;
    height: 30px;
    background-color: #000;
    color: #fff;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    margin: 0 auto 20px;
  }

  .step-img-box {
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 20px;
    overflow: hidden;
    /* Ensure image doesn't bleed out */
  }

  .step-img-box img {
    border-radius: 10px;
    max-width: 100%;
    height: auto;
    display: block;
    /* Remove bottom space */
  }

  .step-desc {
    font-size: 14px;
    line-height: 1.5;
    color: #333;
    word-break: keep-all;
    /* Better text wrapping for Korean */
  }

  /* Pagination Customization */
  .custom-pagination {
    display: none;
    justify-content: center;
    gap: 8px;
    margin-top: 20px;
  }

  .pagination-dot {
    width: 8px;
    height: 8px;
    background-color: #ccc;
    border-radius: 50%;
    cursor: pointer;
    transition: background-color 0.3s;
  }

  .pagination-dot.active {
    background-color: #000;
  }

  /* Mobile Responsive */
  @media (max-width: 768px) {
    .membership-container {
      padding: 40px 20px;
    }

    .section-title {
      font-size: 28px !important;
      /* Slightly smaller for better fit */
      margin-bottom: 30px;
      line-height: 1.3 !important;
    }

    .sub-desc {
      font-size: 14px !important;
      margin-bottom: 30px;
      word-break: keep-all;
    }

    /* Kakao Swiper on Mobile */
    .kakao-steps {
      display: flex;
      justify-content: flex-start;
      /* Force start alignment to prevent clipping */
      flex-wrap: nowrap;
      /* No wrap for slider */
      gap: 0;
      /* Full bleed adjustment */
      margin: 40px -20px 20px;
      padding: 0;
      /* Removed padding to ensure reliable snap */
      overflow-x: auto;
      scroll-snap-type: x mandatory;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none;
      /* Firefox */
      scroll-behavior: smooth;
    }

    .kakao-steps::-webkit-scrollbar {
      display: none;
      /* Chrome/Safari */
    }

    .step-item {
      max-width: none;
      flex: 0 0 100%;
      width: 100%;
      scroll-snap-align: center;
      padding: 0 20px;
      /* spacing inside slide to simulate container padding */
      box-sizing: border-box;
    }

    .step-img-box {
      /* Fix image ratio clipping */
      overflow: visible;
      height: auto;
      aspect-ratio: auto;
    }

    .kakao-swiper {
      padding-bottom: 20px;
      overflow: hidden;
    }

    .custom-pagination {
      display: flex;
    }

    .btn-black {
      width: 100%;
      box-sizing: border-box;
      font-size: 16px;
      padding: 8px 50px;
    }
  }
</style>

<div class="membership-container">
  <!-- Kakao Section -->
  <section class="kakao-section">
    <h2 class="section-title">ì¹´ì¹´ì˜¤ í”Œì¹œ ì¶”ê°€í•˜ê³ <br>10% ì¶”ê°€ í˜œíƒ ë°›ê¸°</h2>
    <p class="sub-desc">
      ì§€ê¸ˆ í•˜ìš°ìŠ¤ë³´ì´ì˜ ì¹´ì¹´ì˜¤ ì±„ë„ì„ íŒ”ë¡œìš°í•˜ì‹œê³ ,<br>
      ì¬ë¯¸ìˆëŠ” ë¸Œëœë“œ ì†Œì‹ê³¼ êµ¬ë§¤ ê¸ˆì•¡ì— ë”°ë¼<br>
      í•¨ê»˜ ì»¤ì§€ëŠ” í˜œíƒì„ ë°›ì•„ë³´ì„¸ìš”
    </p>

    <div class="kakao-swiper">
      <div class="kakao-steps" id="kakaoGrid">
        <div class="step-item">
          <div class="step-num">1</div>
          <div class="step-img-box">
            <img src="https://cdn.imweb.me/thumbnail/20260110/f89871b06f0eb.png" alt="ì¹´ì¹´ì˜¤ì±„ë„ ê²€ìƒ‰"
              style="max-width: 100%; height: auto;">
          </div>
          <p class="step-desc">ì¹´ì¹´ì˜¤ì±„ë„ ê²€ìƒ‰ í›„<br>íŒ”ë¡œìš°í•´ì£¼ì„¸ìš”.</p>
        </div>
        <div class="step-item">
          <div class="step-num">2</div>
          <div class="step-img-box">
            <img src="https://cdn.imweb.me/thumbnail/20260110/0709243be36cc.png" alt="ì›°ì»´ì¿ í°ë°›ê¸°"
              style="max-width: 100%; height: auto;">
          </div>
          <p class="step-desc">ì±„ë„ ì¶”ê°€ ì›°ì»´ ë©”ì‹œì§€ë¥¼<br>í™•ì¸í•´ì£¼ì„¸ìš”.</p>
        </div>
        <div class="step-item">
          <div class="step-num">3</div>
          <div class="step-img-box">
            <img src="https://cdn.imweb.me/thumbnail/20260110/89c2e8efc40b7.png" alt="ì¿ í°ë²ˆí˜¸ ë³µì‚¬"
              style="max-width: 100%; height: auto;">
          </div>
          <p class="step-desc">ì›°ì»´ ë©”ì‹œì§€ í•˜ë‹¨ì˜<br>â€˜ì¿ í°íŒ© ë°›ê¸° ğŸ«â€™ ë²„íŠ¼ í´ë¦­</p>
        </div>
        <div class="step-item">
          <div class="step-num">4</div>
          <div class="step-img-box">
            <img src="https://cdn.imweb.me/thumbnail/20260110/9987182cad7f5.png" alt="ì¿ í° ì½”ë“œ ì…ë ¥"
              style="max-width: 100%; height: auto;">
          </div>
          <p class="step-desc">ë¡œê·¸ì¸í•˜ì‹  ë’¤, ìƒí’ˆ êµ¬ë§¤ ë‹¨ê³„ì—ì„œ<br>ì¿ í°ì„ ì ìš©í•´ì£¼ì„¸ìš”.</p>
        </div>
      </div>
      <div class="custom-pagination" id="kakaoPagination"></div>
    </div>

    <a href="https://pf.kakao.com/_bjGQxj" class="btn-black">ì¹´ì¹´ì˜¤ í”Œì¹œ ì¶”ê°€í•˜ê³  ì¶”ê°€ í˜œíƒ ë°›ê¸°</a>
  </section>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    function setupSlider(gridId, paginationId) {
      const grid = document.getElementById(gridId);
      const pagination = document.getElementById(paginationId);

      if (!grid || !pagination) return;

      const items = grid.children;

      // Create pagination dots
      pagination.innerHTML = '';
      for (let i = 0; i < items.length; i++) {
        const dot = document.createElement('div');
        dot.classList.add('pagination-dot');
        if (i === 0) dot.classList.add('active');

        // Improved click handling
        dot.addEventListener('click', () => {
          // Identify the position of the target item
          // offsetLeft is relative to the offsetParent (which should be the grid if positioned, or we use calc)
          // Since grid is a flex container, simpler to using scrollTo with the item's offsetLeft relative to the grid
          const offset = items[i].offsetLeft;
          grid.scrollTo({
            left: offset,
            behavior: 'smooth'
          });
        });

        pagination.appendChild(dot);
      }

      // Update active dot on scroll using IntersectionObserver
      const observerOptions = {
        root: grid,
        threshold: 0.6 // Increased threshold to ensure we only highlight when mostly visible
      };

      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            const index = Array.from(items).indexOf(entry.target);
            const dots = pagination.children;

            if (dots && dots.length > 0) {
              // Reset all
              for (let d of dots) d.classList.remove('active');
              // Set active
              if (dots[index]) dots[index].classList.add('active');
            }
          }
        });
      }, observerOptions);

      Array.from(items).forEach(item => observer.observe(item));
    }

    // Initialize sliders
    setupSlider('kakaoGrid', 'kakaoPagination');
  });
</script>